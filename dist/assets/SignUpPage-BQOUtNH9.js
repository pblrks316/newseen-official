import{r as a,o as U,c as f,b as s,w as N,h as l,v as u,a as h,d as y,u as x,j as k,k as O,R as E,l as j,g as b,m as V}from"./index-CwmDPFDR.js";import{l as d}from"./index-Cm3sRm-2.js";import{L as C}from"./LoopingRhombusesSpinner-LOJSja91.js";const I={class:"flex items-center justify-center min-h-screen"},P={class:"w-90 max-w-md p-8 gap-y-6 rounded-lg"},L={class:"mt-1 pb-3"},q={class:"mt-1 pb-3"},A={class:"mt-1 pb-3"},B={class:"mt-1 pb-5"},z={class:"pb-4"},F=["disabled"],G={key:0},M={key:1,class:"h-5 flex justify-center items-center"},X={class:"text-center"},D={class:"text-sm text-rose-700"},H={href:"#",class:"font-medium text-rose-600 hover:underline"},W={__name:"SignUpPage",setup(J){const _="https://api.newseen.com",v=j(),i=a(""),m=a(""),n=a(""),c=a(""),r=a(!1),w=a(!1),S=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$#!%*?&]+$/,p=o=>{d.error(o||"Signup failed",{autoClose:9e3,position:d.POSITION.TOP_RIGHT})},R=o=>{d.success(o,{autoClose:2e3,position:d.POSITION.TOP_RIGHT})},T=async()=>{r.value=!0,w.value=!0;try{if(!V(()=>S.test(n.value)).value)throw new Error("Your password does not meet the requirements. Use a combination of at least 8 characters long contains: 1 uppercase and lowercase letter, 1 number and symbol in the following brackets (# @ $ ! % * ? &).");await fetch("https://api.newseen.com/sanctum/csrf-cookie",{credentials:"include"});const o=await fetch(`${_}/api/register`,{method:"POST",headers:{"Content-Type":"application/json","X-XSRF-TOKEN":g("XSRF-TOKEN")},credentials:"include",body:JSON.stringify({username:m.value,name:c.value,email:i.value,password:n.value,password_confirmation:n.value,role:"pembaca",membership:"free"})}),e=await o.json();if(!o.ok)throw new Error(e.message||"Failed while signing up, make sure your username and email is not used by other person, then try again.");R(e.message),v.push(`/verify-sent?email=${i.value}`)}catch(o){p(o.message)}finally{r.value=!1,w.value=!1}},g=o=>{const t=`; ${document.cookie}`.split(`; ${o}=`);return t.length===2?decodeURIComponent(t.pop().split(";").shift()):null},$=async()=>{try{const o=await fetch("https://api.newseen.com/api/myinfo",{method:"GET",headers:{accept:"application/json",Authorization:`Bearer ${g("access_token")}`}}),e=await o.json();o.status==401?p(e.message):o.ok?e.username&&v.push("/me"):p(e.message)}catch(o){console.log(o)}};return U(async()=>{await $()}),(o,e)=>(b(),f("div",I,[s("div",P,[e[10]||(e[10]=s("div",null,[s("h2",{class:"text-2xl pb-3 font-bold text-center text-rose-900"}," Join our community! "),s("p",{class:"mt-2 text-sm pb-3 text-center text-rose-700"}," Sign up to enjoy premium articles and interactive features. ")],-1)),s("form",{class:"gap-y-6",onSubmit:N(T,["prevent"])},[s("div",null,[e[4]||(e[4]=s("label",{for:"username",class:"block pb-2 text-sm font-medium text-rose-900"}," Username ",-1)),s("div",L,[l(s("input",{id:"username",name:"username",type:"text","onUpdate:modelValue":e[0]||(e[0]=t=>m.value=t),required:"",class:"w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-rose-500 focus:border-rose-500"},null,512),[[u,m.value]])])]),s("div",null,[e[5]||(e[5]=s("label",{for:"email",class:"block pb-2 text-sm font-medium text-rose-900"}," Email ",-1)),s("div",q,[l(s("input",{id:"email",name:"email",type:"email","onUpdate:modelValue":e[1]||(e[1]=t=>i.value=t),required:"",class:"w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-rose-500 focus:border-rose-500"},null,512),[[u,i.value]])])]),s("div",null,[e[6]||(e[6]=s("label",{for:"name",class:"block pb-2 text-sm font-medium text-rose-900"}," Name ",-1)),s("div",A,[l(s("input",{id:"name",name:"name",type:"name","onUpdate:modelValue":e[2]||(e[2]=t=>c.value=t),required:"",class:"w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-rose-500 focus:border-rose-500"},null,512),[[u,c.value]])])]),s("div",null,[e[7]||(e[7]=s("label",{for:"password",class:"block pb-2 text-sm font-medium text-rose-900"}," Password ",-1)),s("div",B,[l(s("input",{id:"password",name:"password",type:"password","onUpdate:modelValue":e[3]||(e[3]=t=>n.value=t),required:"",class:"w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-rose-500 focus:border-rose-500"},null,512),[[u,n.value]])])]),s("div",z,[s("button",{disabled:r.value,type:"submit",class:"w-full px-4 py-2 text-sm font-semibold text-rose-900 bg-rose-300 rounded-md shadow-sm hover:bg-rose-400 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-rose-500 transition-colors"},[r.value?h("",!0):(b(),f("div",G," Sign up ")),r.value?(b(),f("div",M,[y(x(C))])):h("",!0)],8,F)])],32),s("div",X,[s("p",D,[e[9]||(e[9]=k(" Already have an account? ",-1)),s("a",H,[y(x(E),{to:"/login"},{default:O(()=>[...e[8]||(e[8]=[k("Sign in here.",-1)])]),_:1})])])])])]))}};export{W as default};
