import{r as n,c as i,b as s,w as S,h as u,v as c,a as p,d as x,u as _,j as T,k as N,R as C,l as j,g as d}from"./index-BHL27wsW.js";import{l as m}from"./index-Bi9A1Cp9.js";import{L as O}from"./LoopingRhombusesSpinner-DgFpKxhR.js";const E={class:"flex items-center justify-center min-h-screen"},X={class:"w-90 max-w-md p-8 gap-y-6 rounded-lg"},F={class:"mt-1 pb-3"},U={class:"mt-1 pb-5"},V={class:"mt-1 pb-5"},$={class:"mt-1 pb-5"},I={class:"pb-4"},q=["disabled"],K={key:0},L={key:1,class:"h-5 flex justify-center items-center"},B={class:"pb-4"},A=["disabled"],D={key:0},J={key:1,class:"h-5 flex justify-center items-center"},G={class:"text-center"},H={class:"text-sm text-rose-700"},M={href:"#",class:"font-medium text-rose-600 hover:underline"},ee={__name:"ResetPassword",setup(z){const f="https://api.newseen.com";j();const l=n(""),w=n(""),b=n(""),v=n(""),t=n(!1),r=n(!1),g=o=>{m.error(`Error: ${o}`,{autoClose:2e3,position:m.POSITION.TOP_RIGHT})},y=o=>{m.success(`${o}`,{autoClose:2e3,position:m.POSITION.TOP_RIGHT})},h=o=>{const a=`; ${document.cookie}`.split(`; ${o}=`);return a.length===2?decodeURIComponent(a.pop().split(";").shift()):null},k=async()=>{t.value=!0,r.value=!0;try{const o=await fetch(`${f}/api/send-otp`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-XSRF-TOKEN":h("XSRF-TOKEN")},body:JSON.stringify({email:l.value}),credentials:"include"}),e=await o.json();if(o.ok)y(e.message);else throw new Error(e.message||"OTPs Request Failed, try again.")}catch(o){g(o.message)}finally{t.value=!1,r.value=!1}},R=async()=>{t.value=!0,r.value=!0;try{const o=await fetch(`${f}/api/send-otp`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-XSRF-TOKEN":h("XSRF-TOKEN")},body:JSON.stringify({email:l.value}),credentials:"include"}),e=await o.json();if(o.ok)y(e.message);else throw new Error(e.message||"OTPs Request Failed, try again.")}catch(o){g(o.message)}finally{t.value=!1,r.value=!1}},P=async()=>{t.value=!0,r.value=!0;try{const o=await fetch(`${f}/api/reset-password-otp`,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json","X-XSRF-TOKEN":h("XSRF-TOKEN")},body:JSON.stringify({email:l.value,otp:w.value,new_password:b.value,new_password_confirmation:v.value}),credentials:"include"}),e=await o.json();if(o.ok)y(e.message);else throw new Error(e.message||"Password resets failed, try again!")}catch(o){g(o.message)}finally{t.value=!1,r.value=!1}};return(o,e)=>(d(),i("div",E,[s("div",X,[e[10]||(e[10]=s("div",null,[s("h2",{class:"text-2xl pb-3 font-bold text-center text-rose-900"}," Reset Password "),s("p",{class:"mt-2 text-sm pb-3 text-center text-rose-700"}," Dont forget to change your password for each 90 days. ")],-1)),s("form",{class:"gap-y-6",onSubmit:S(k,["prevent"])},[s("div",null,[e[4]||(e[4]=s("label",{for:"email",class:"block pb-2 text-sm font-medium text-rose-900"}," Email ",-1)),s("div",F,[u(s("input",{id:"email",name:"email",type:"text","onUpdate:modelValue":e[0]||(e[0]=a=>l.value=a),required:"",class:"w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-rose-500 focus:border-rose-500"},null,512),[[c,l.value]])])]),s("div",null,[e[5]||(e[5]=s("label",{for:"password",class:"block pb-2 text-sm font-medium text-rose-900"}," OTP Code ",-1)),s("div",U,[u(s("input",{id:"otp",name:"password",type:"text","onUpdate:modelValue":e[1]||(e[1]=a=>w.value=a),required:"",class:"w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-rose-500 focus:border-rose-500"},null,512),[[c,w.value]])])]),s("div",null,[e[6]||(e[6]=s("label",{for:"password",class:"block pb-2 text-sm font-medium text-rose-900"}," New Password ",-1)),s("div",V,[u(s("input",{id:"otp",name:"password",type:"password","onUpdate:modelValue":e[2]||(e[2]=a=>b.value=a),required:"",class:"w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-rose-500 focus:border-rose-500"},null,512),[[c,b.value]])])]),s("div",null,[e[7]||(e[7]=s("label",{for:"password",class:"block pb-2 text-sm font-medium text-rose-900"}," Confirm New Password ",-1)),s("div",$,[u(s("input",{id:"otp",name:"password",type:"password","onUpdate:modelValue":e[3]||(e[3]=a=>v.value=a),required:"",class:"w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-rose-500 focus:border-rose-500"},null,512),[[c,v.value]])])]),s("div",I,[s("button",{onClick:P,disabled:t.value,type:"submit",class:"w-full px-4 py-2 text-sm font-semibold text-rose-900 bg-rose-300 rounded-md shadow-sm hover:bg-rose-400 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-rose-500 transition-colors"},[t.value?p("",!0):(d(),i("div",K," Change Password ")),t.value?(d(),i("div",L,[x(_(O))])):p("",!0)],8,q)])],32),s("div",B,[s("button",{onClick:R,disabled:t.value,type:"submit",class:"w-full px-4 py-2 text-sm font-semibold text-rose-900 bg-rose-300 rounded-md shadow-sm hover:bg-rose-400 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-rose-500 transition-colors"},[t.value?p("",!0):(d(),i("div",D," Send OTP Code ")),t.value?(d(),i("div",J,[x(_(O))])):p("",!0)],8,A)]),s("div",G,[s("p",H,[e[9]||(e[9]=T(" Don't want to change your password? ",-1)),s("a",M,[x(_(C),{to:"/login"},{default:N(()=>[...e[8]||(e[8]=[T("Back to login page.",-1)])]),_:1})])])])])]))}};export{ee as default};
