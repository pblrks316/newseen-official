import{r as n,o as $,c as p,b as s,w as N,h as l,v as u,a as g,d as w,u as h,j as y,k as O,R as E,l as j,g as f,m as V}from"./index-BDEM5uhp.js";import{l as d}from"./index-CY3PEhU-.js";import{L as C}from"./LoopingRhombusesSpinner-BOHGaTpo.js";const I={class:"flex items-center justify-center min-h-screen"},P={class:"w-90 max-w-md p-8 gap-y-6 rounded-lg"},L={class:"mt-1 pb-3"},q={class:"mt-1 pb-3"},A={class:"mt-1 pb-3"},B={class:"mt-1 pb-5"},F={class:"pb-4"},G=["disabled"],M={key:0},X={key:1,class:"h-5 flex justify-center items-center"},z={class:"text-center"},D={class:"text-sm text-rose-700"},H={href:"#",class:"font-medium text-rose-600 hover:underline"},W={__name:"SignUpPage",setup(J){const x="https://api.newseen.com",b=j(),i=n(""),m=n(""),a=n(""),c=n(""),r=n(!1),v=n(!1),k=/^(?=.*[a-z])(?=.*[A-Z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$#!%*?&]+$/,_=o=>{d.error(o||"Signup failed",{autoClose:9e3,position:d.POSITION.TOP_RIGHT})},S=o=>{d.success(o,{autoClose:2e3,position:d.POSITION.TOP_RIGHT})},R=async()=>{r.value=!0,v.value=!0;try{if(!V(()=>k.test(a.value)).value)throw new Error("Your password does not meet the requirements. Use a combination of at least 8 characters long contains: 1 uppercase and lowercase letter, 1 number and symbol in the following brackets (# @ $ ! % * ? &).");await fetch("https://api.newseen.com/sanctum/csrf-cookie",{credentials:"include"});const o=await fetch(`${x}/api/register`,{method:"POST",headers:{"Content-Type":"application/json","X-XSRF-TOKEN":T("XSRF-TOKEN")},credentials:"include",body:JSON.stringify({username:m.value,name:c.value,email:i.value,password:a.value,password_confirmation:a.value,role:"pembaca",membership:"free"})}),e=await o.json();if(!o.ok)throw new Error(e.message||"Failed while signing up, make sure your username and email is not used by other person, then try again.");S(e.message),b.push(`/verify-sent?email=${i.value}`)}catch(o){_(o.message)}finally{r.value=!1,v.value=!1}},T=o=>{const t=`; ${document.cookie}`.split(`; ${o}=`);return t.length===2?decodeURIComponent(t.pop().split(";").shift()):null},U=async()=>{try{const o=await fetch("https://api.newseen.com/api/myinfo",{method:"GET",headers:{accept:"application/json"},credentials:"include"}),e=await o.json();o.status==401?console.log(e.message):o.ok?e.username&&b.push("/me"):console.log(e.message)}catch(o){console.log(o)}};return $(async()=>{await U()}),(o,e)=>(f(),p("div",I,[s("div",P,[e[10]||(e[10]=s("div",null,[s("h2",{class:"text-2xl pb-3 font-bold text-center text-rose-900"}," Join our community! "),s("p",{class:"mt-2 text-sm pb-3 text-center text-rose-700"}," Sign up to enjoy premium articles and interactive features. ")],-1)),s("form",{class:"gap-y-6",onSubmit:N(R,["prevent"])},[s("div",null,[e[4]||(e[4]=s("label",{for:"username",class:"block pb-2 text-sm font-medium text-rose-900"}," Username ",-1)),s("div",L,[l(s("input",{id:"username",name:"username",type:"text","onUpdate:modelValue":e[0]||(e[0]=t=>m.value=t),required:"",class:"w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-rose-500 focus:border-rose-500"},null,512),[[u,m.value]])])]),s("div",null,[e[5]||(e[5]=s("label",{for:"email",class:"block pb-2 text-sm font-medium text-rose-900"}," Email ",-1)),s("div",q,[l(s("input",{id:"email",name:"email",type:"email","onUpdate:modelValue":e[1]||(e[1]=t=>i.value=t),required:"",class:"w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-rose-500 focus:border-rose-500"},null,512),[[u,i.value]])])]),s("div",null,[e[6]||(e[6]=s("label",{for:"name",class:"block pb-2 text-sm font-medium text-rose-900"}," Name ",-1)),s("div",A,[l(s("input",{id:"name",name:"name",type:"name","onUpdate:modelValue":e[2]||(e[2]=t=>c.value=t),required:"",class:"w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-rose-500 focus:border-rose-500"},null,512),[[u,c.value]])])]),s("div",null,[e[7]||(e[7]=s("label",{for:"password",class:"block pb-2 text-sm font-medium text-rose-900"}," Password ",-1)),s("div",B,[l(s("input",{id:"password",name:"password",type:"password","onUpdate:modelValue":e[3]||(e[3]=t=>a.value=t),required:"",class:"w-full px-3 py-2 bg-white border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-rose-500 focus:border-rose-500"},null,512),[[u,a.value]])])]),s("div",F,[s("button",{disabled:r.value,type:"submit",class:"w-full px-4 py-2 text-sm font-semibold text-rose-900 bg-rose-300 rounded-md shadow-sm hover:bg-rose-400 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-rose-500 transition-colors"},[r.value?g("",!0):(f(),p("div",M," Sign up ")),r.value?(f(),p("div",X,[w(h(C))])):g("",!0)],8,G)])],32),s("div",z,[s("p",D,[e[9]||(e[9]=y(" Already have an account? ",-1)),s("a",H,[w(h(E),{to:"/login"},{default:O(()=>[...e[8]||(e[8]=[y("Sign in here.",-1)])]),_:1})])])])])]))}};export{W as default};
